{% extends 'base.html' %}
{% block content %}
<div class="max-w-3xl mx-auto animate-fadeIn">

    <!-- Header -->
    <div class="text-center pb-12">
        <h1 class="text-4xl font-bold tracking-tight text-white sm:text-5xl">Create a New Forecast</h1>
        <p class="mt-4 text-lg leading-8 text-slate-300">Pinpoint your event location on the map, add your details, and let our AI provide a detailed weather outlook.</p>
    </div>

    <div class="bg-slate-800/50 p-6 sm:p-8 rounded-2xl border border-slate-800">
        <form method="POST" action="{% url 'userside:dashboard' %}" class="space-y-8">
            {% csrf_token %}
            <!-- Step 1: Map Selection -->
            <div>
                <h2 class="text-xl font-bold text-white flex items-center gap-3 mb-4">
                    <span class="bg-sky-500 text-slate-900 text-sm font-bold rounded-full h-7 w-7 flex items-center justify-center">1</span>
                    Choose Your Location
                </h2>
                <p class="text-sm text-center text-slate-400 mb-3">Click on the map or drag the pin to select your event location.</p>
                <div id="map" class="h-80 sm:h-96 w-full rounded-lg border border-slate-700 z-0"></div>
                <div id="coords-display" class="text-center text-white bg-slate-700/50 rounded-md p-2 mt-4 text-sm font-mono">
                   <!-- Coordinates will be displayed here by JavaScript -->
                </div>
                <div class="hidden">
                   <input type="text" id="latitude" name = "lat">
                   <input type="text" id="longitude"name = "lon">
                </div>
            </div>

            <!-- Step 2: Event Details -->
            <div>
                <h2 class="text-xl font-bold text-white flex items-center gap-3 mb-4">
                    <span class="bg-sky-500 text-slate-900 text-sm font-bold rounded-full h-7 w-7 flex items-center justify-center">2</span>
                    Enter Event Details
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    <div>
                       <label for="date" class="block text-sm font-medium text-slate-400 mb-1">Date</label>
                       <input type="date" id="date" name = "date" class="w-full bg-slate-700 border-slate-600 rounded-lg p-2.5 text-white focus:ring-sky-500 focus:border-sky-500">
                   </div>
                    <div>
                       <label for="event-type" class="block text-sm font-medium text-slate-400 mb-1">Event Type</label>
                       <select id="event-type" class="w-full bg-slate-700 border-slate-600 rounded-lg p-2.5 text-white focus:ring-sky-500 focus:border-sky-500">
                           <option>Choose...</option>
                           <option value="Parade">Parade</option>
                           <option value="Wedding">Wedding</option>
                           <option value="Picnic">Picnic</option>
                           <option value="Marathon">Marathon</option>
                           <option value="Other">Other</option>
                       </select>
                   </div>
                </div>
            </div>

            <button type="submit" class="w-full !mt-10 bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2">
                <i data-lucide="wand-2" class="h-5 w-5"></i>
                Get Prediction
            </button>
        </form>
    </div>
    
    <!-- Results Section -->
    <div id="prediction-results" class="hidden mt-10">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-white">Your Forecast is Ready</h2>
        </div>
        <div class="space-y-6">
            <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-800">
                <h4 class="text-lg font-semibold text-white mb-4">Prediction Summary</h4>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between items-center"><span class="text-slate-400">Chance of Rain</span> <strong class="text-white text-base" id="rain-chance"></strong></div>
                    <div class="flex justify-between items-center"><span class="text-slate-400">Expected Temperature</span> <strong class="text-white text-base" id="temperature"></strong></div>
                    <div class="flex justify-between items-center"><span class="text-slate-400">Wind Speed</span> <strong class="text-white text-base" id="wind-speed"></strong></div>
                </div>
           </div>
            <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-800">
                <h4 class="text-lg font-semibold text-white mb-4 flex items-center gap-2"><i data-lucide="sparkles" class="text-yellow-400 h-5 w-5"></i>AI Insights</h4>
                <div class="space-y-4 text-sm">
                   <div>
                       <h5 class="font-semibold text-white mb-1">Summary</h5>
                       <p class="text-slate-400" id="ai-summary"></p>
                   </div>
                   <div class="border-t border-slate-700 my-4"></div>
                   <div>
                       <h5 class="font-semibold text-white mb-2">Parade Planner</h5>
                       <p class="text-slate-400"><strong class="text-slate-200">Outlook:</strong> <span id="ai-outlook"></span></p>
                       <p class="text-slate-400"><strong class="text-slate-200">Clothing:</strong> <span id="ai-clothing"></span></p>
                       <p class="text-slate-400"><strong class="text-slate-200">Contingency:</strong> <span id="ai-contingency"></span></p>
                   </div>
                   <div class="border-t border-slate-700 my-4"></div>
                   <div>
                       <h5 class="font-semibold text-white mb-1">NASA Fun Fact</h5>
                       <p class="text-slate-400" id="ai-fun-fact"></p>
                   </div>
                </div>
           </div>
        </div>
    </div>
</div>

<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn {
        animation: fadeIn 0.6s ease-in-out forwards;
    }
</style>
{% endblock %}

