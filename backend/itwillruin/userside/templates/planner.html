{% extends "base.html" %}

{% block content %}
<h1>Will It Rain On My Parade?</h1>

<form method="post">
    {% csrf_token %}
    <!-- Your form fields for location and date go here -->
    <input type="text" name="location" placeholder="Enter a location" required>
    <input type="date" name="date" required>
    <button type="submit">Analyze Weather</button>
</form>

{% if submitted %}
    <hr>
    <h2>Results for {{ historical_data.location }} in {{ historical_data.time_period }}</h2>

    {% if ai_insights %}
        <div class="ai-summary-card">
            <h3>ðŸ¤– AI-Powered Summary & Recommendations</h3>
            
            <p><strong>Weather Snapshot:</strong> {{ ai_insights.summary }}</p>
            
            <h4>Parade Planner</h4>
            <ul>
                <li><strong>Overall Outlook:</strong> 
                    <span class="outlook-{{ ai_insights.parade_planner.overall_outlook|lower|slugify }}">
                        {{ ai_insights.parade_planner.overall_outlook }}
                    </span>
                </li>
                <li><strong>What to Wear:</strong> {{ ai_insights.parade_planner.clothing_recommendation }}</li>
                <li><strong>Contingency Plan:</strong> {{ ai_insights.parade_planner.contingency_plan }}</li>
            </ul>

            <div class="fun-fact">
                <p><strong>ðŸš€ NASA Fun Fact:</strong> {{ ai_insights.nasa_fun_fact }}</p>
            </div>
        </div>
    {% else %}
        <p>Could not retrieve AI-powered insights. Please try again later.</p>
    {% endif %}

    <!-- You can also display the raw historical data here -->
    <div class="raw-data">
        <h3>Historical Data</h3>
        <p>Average Temperature: {{ historical_data.avg_temp_c }}Â°C</p>
        <p>Chance of Rain: {{ historical_data.chance_of_rain_percent }}%</p>
        <!-- ... more data ... -->
    </div>
{% endif %}

<style>
    .ai-summary-card { border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-top: 20px; background-color: #f9f9f9; }
    .fun-fact { background-color: #e3f2fd; border-left: 4px solid #2196f3; padding: 10px; margin-top: 15px; }
    .outlook-good { color: green; font-weight: bold; }
    .outlook-fair-with-caution { color: orange; font-weight: bold; }
    .outlook-challenging { color: red; font-weight: bold; }
</style>
{% endblock %}